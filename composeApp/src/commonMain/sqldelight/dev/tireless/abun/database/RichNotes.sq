CREATE TABLE rich_note (
  id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
  title TEXT NOT NULL,
  content TEXT NOT NULL,
  pinned INTEGER NOT NULL DEFAULT 0,
  created_at INTEGER NOT NULL,
  updated_at INTEGER NOT NULL
);

CREATE TABLE rich_note_tag (
  note_id INTEGER NOT NULL,
  tag_id INTEGER NOT NULL,
  PRIMARY KEY (note_id, tag_id),
  FOREIGN KEY (note_id) REFERENCES rich_note (id) ON DELETE CASCADE,
  FOREIGN KEY (tag_id) REFERENCES tag (id) ON DELETE CASCADE
);

selectAllRichNotes:
SELECT * FROM rich_note
ORDER BY pinned DESC, updated_at DESC, title COLLATE NOCASE;

selectRichNoteById:
SELECT * FROM rich_note WHERE id = ?;

selectRichNoteTagLinks:
SELECT note_id, tag_id FROM rich_note_tag;

selectTagIdsForRichNote:
SELECT tag_id FROM rich_note_tag WHERE note_id = ?;

insertRichNote:
INSERT INTO rich_note (title, content, pinned, created_at, updated_at)
VALUES (?, ?, ?, ?, ?);

updateRichNote:
UPDATE rich_note
SET title = ?, content = ?, pinned = ?, updated_at = ?
WHERE id = ?;

deleteRichNote:
DELETE FROM rich_note WHERE id = ?;

deleteRichNoteTags:
DELETE FROM rich_note_tag WHERE note_id = ?;

insertRichNoteTag:
INSERT INTO rich_note_tag (note_id, tag_id)
VALUES (?, ?);

lastInsertedRichNoteId:
SELECT last_insert_rowid();
